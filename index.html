<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mari Berhitung</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #ffffff;
            --accent: #4fc3f7;
            --correct: #66bb6a;
            --wrong: #ef5350;
        }
        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; margin: 0; background-color: var(--bg-color); color: var(--text-color);
        }
        .container { 
            background: var(--card-bg); 
            padding: 30px 20px;
            border-radius: 24px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.5); 
            width: 85%; 
            max-width: 400px; 
            text-align: center; 
        }
        .question-box { font-size: 2.5rem; margin: 25px 0; font-weight: bold; height: 70px; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .answer-display { border-bottom: 4px solid var(--accent); min-width: 65px; height: 50px; color: var(--accent); display: inline-block; }
        .feedback { font-size: 2rem; width: 30px; }
        
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 25px; }
        button { 
            padding: 18px 5px; font-size: 1.4rem; border: none; border-radius: 15px; 
            background: #424242; color: white; cursor: pointer; transition: 0.1s;
            -webkit-tap-highlight-color: transparent;
        }
        button:active { transform: scale(0.9); background: #616161; }
        .btn-check { grid-column: span 2; background: var(--accent); font-weight: bold; }
        .btn-clear { background: #546e7a; font-size: 1rem; }
        
        .score-info { margin-top: 25px; font-size: 1.1rem; color: #bbb; }
        .result-screen { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="gameScreen">
        <h2 style="margin:0; color: #bbb; font-weight: normal;">Mari Berhitung</h2>
        <div class="question-box">
            <span id="questionText">--</span> = 
            <span id="answerDisplay" class="answer-display"></span>
            <span id="feedbackIcon" class="feedback"></span>
        </div>

        <div class="grid">
            <button onclick="inputNumber(1)">1</button>
            <button onclick="inputNumber(2)">2</button>
            <button onclick="inputNumber(3)">3</button>
            <button onclick="inputNumber(4)">4</button>
            <button onclick="inputNumber(5)">5</button>
            <button onclick="inputNumber(6)">6</button>
            <button onclick="inputNumber(7)">7</button>
            <button onclick="inputNumber(8)">8</button>
            <button onclick="inputNumber(9)">9</button>
            <button onclick="clearAnswer()" class="btn-clear">Hapus</button>
            <button onclick="inputNumber(0)">0</button>
            <button onclick="checkAnswer()" class="btn-check">OKE</button>
        </div>
        <div class="score-info">Pertanyaan <span id="currentIndex">1</span> / 15</div>
    </div>

    <div id="resultScreen" class="result-screen">
        <h2>Sesi Selesai</h2>
        <p>Skor Akhir Anda:</p>
        <h1 id="finalScore" style="font-size: 4.5rem; color: var(--accent); margin: 10px 0;">0</h1>
        <p id="summaryText" style="font-size: 1.2rem; margin-bottom: 30px;"></p>
        <button onclick="location.reload()" style="width: 100%; background: var(--accent); border-radius: 15px; padding: 15px; color: white; font-size: 1.2rem; border: none;">Main Lagi</button>
    </div>
</div>

<script>
    // Database 60 Soal dengan Komposisi:
    // Tambah (32% = 19), Kurang (32% = 19), Kali (18% = 11), Bagi (18% = 11)
    const database = [
        // TAMBAH (19 soal)
        {q:"12+15", a:27}, {q:"24+36", a:60}, {q:"45+12", a:57}, {q:"33+17", a:50}, {q:"50+22", a:72},
        {q:"18+14", a:32}, {q:"27+23", a:50}, {q:"40+15", a:55}, {q:"66+11", a:77}, {q:"25+45", a:70},
        {q:"19+21", a:40}, {q:"38+12", a:50}, {q:"55+15", a:70}, {q:"14+16", a:30}, {q:"22+28", a:50},
        {q:"70+20", a:90}, {q:"13+17", a:30}, {q:"44+16", a:60}, {q:"31+19", a:50},
        // KURANG (19 soal)
        {q:"45-12", a:33}, {q:"90-33", a:57}, {q:"56-12", a:44}, {q:"75-25", a:50}, {q:"88-44", a:44},
        {q:"60-14", a:46}, {q:"85-20", a:65}, {q:"70-35", a:35}, {q:"40-18", a:22}, {q:"95-15", a:80},
        {q:"55-11", a:44}, {q:"77-22", a:55}, {q:"80-15", a:65}, {q:"50-12", a:38}, {q:"88-18", a:70},
        {q:"45-15", a:30}, {q:"30-15", a:15}, {q:"99-44", a:55}, {q:"65-30", a:35},
        // KALI (11 soal - pake x)
        {q:"12 x 4", a:48}, {q:"11 x 6", a:66}, {q:"13 x 3", a:39}, {q:"5 x 15", a:75}, {q:"7 x 12", a:84},
        {q:"11 x 11", a:121}, {q:"14 x 3", a:42}, {q:"16 x 2", a:32}, {q:"8 x 8", a:64}, {q:"12 x 5", a:60},
        {q:"6 x 14", a:84},
        // BAGI (11 soal)
        {q:"99/9", a:11}, {q:"80/4", a:20}, {q:"64/8", a:8}, {q:"100/5", a:20}, {q:"42/2", a:21},
        {q:"36/3", a:12}, {q:"90/5", a:18}, {q:"48/4", a:12}, {q:"72/6", a:12}, {q:"63/9", a:7},
        {q:"45/3", a:15}
    ];

    let sessionQuestions = [];
    let currentIdx = 0;
    let userTyped = "";
    let correctAnswers = 0;

    function playSound(type) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain); gain.connect(ctx.destination);
        
        if(type === 'correct') {
            osc.type = "sine"; osc.frequency.value = 880;
        } else {
            osc.type = "sawtooth"; osc.frequency.value = 110;
        }
        
        gain.gain.setValueAtTime(0.1, ctx.currentTime);
        osc.start(); gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.5);
        osc.stop(ctx.currentTime + 0.5);
    }

    function initGame() {
        sessionQuestions = database.sort(() => 0.5 - Math.random()).slice(0, 15);
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('questionText').innerText = sessionQuestions[currentIdx].q;
        document.getElementById('answerDisplay').innerText = userTyped;
        document.getElementById('currentIndex').innerText = currentIdx + 1;
        document.getElementById('feedbackIcon').innerText = "";
    }

    function inputNumber(num) {
        if (userTyped.length < 4) {
            userTyped += num;
            document.getElementById('answerDisplay').innerText = userTyped;
        }
    }

    function clearAnswer() {
        userTyped = "";
        document.getElementById('answerDisplay').innerText = "";
    }

    function checkAnswer() {
        if (userTyped === "") return;
        const feedback = document.getElementById('feedbackIcon');
        const isCorrect = parseInt(userTyped) === sessionQuestions[currentIdx].a;

        if (isCorrect) {
            feedback.innerText = "✔️";
            feedback.style.color = "var(--correct)";
            correctAnswers++;
            playSound('correct');
        } else {
            feedback.innerText = "❌";
            feedback.style.color = "var(--wrong)";
            playSound('wrong');
        }

        setTimeout(nextQuestion, 800);
    }

    function nextQuestion() {
        if (currentIdx < sessionQuestions.length - 1) {
            currentIdx++;
            userTyped = "";
            updateDisplay();
        } else {
            showResult();
        }
    }

    function showResult() {
        document.getElementById('gameScreen').style.display = 'none';
        document.getElementById('resultScreen').style.display = 'block';
        let score = Math.round((correctAnswers / 15) * 100);
        document.getElementById('finalScore').innerText = score;
        document.getElementById('summaryText').innerText = `Benar ${correctAnswers} dari 15 soal.`;
    }

    initGame();
</script>

</body>
</html>
